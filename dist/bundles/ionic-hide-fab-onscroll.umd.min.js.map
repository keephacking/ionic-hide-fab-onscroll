{"version":3,"sources":["ng://ionic-hide-fab-onscroll/hide-fab-onscroll.directive.ts","ng://ionic-hide-fab-onscroll/hide-fab-onscroll.module.ts"],"names":["HideFabOnscrollDirective","el","renderer","zone","plt","domCtrl","app","this","prototype","ngAfterViewInit","_this","initFab","scroll","ScrollView","enableEvents","runOutsideAngular","init","content","getScrollElement","_cTop","_cBottom","onScroll","ev","scrollDir","directionY","scrollTop","onScrollStart","render","ngOnDestroy","destroy","ts","rAFInt","raf","isScrolling","hideFab","cancelRaf","timestamp","BOTTOM_THRESHOLD","setStyle","fab","Css","transform","TOP_THRESHOLD","nativeElement","transition","TRANSITION_DELAY","Directive","args","selector","ElementRef","Renderer2","NgZone","Platform","DomController","App","Input","HideFabOnscrollModule","NgModule","declarations","exports"],"mappings":"8ZAAA,IAAAA,EAAA,WAgCE,SAAAA,EACUC,EACAC,EAEAC,EACDC,EACCC,EACAC,GANAC,KAAAN,GAAAA,EACAM,KAAAL,SAAAA,EAEAK,KAAAJ,KAAAA,EACDI,KAAAH,IAAAA,EACCG,KAAAF,QAAAA,EACAE,KAAAD,IAAAA,qBAtBc,yBACG,yBACA,uBAKP,oBACA,SAiBpBN,EAAAQ,UAAAC,gBAAA,WAAA,IAAAC,EAAAH,KAEEA,KAAKI,UAGLJ,KAAKK,OAAS,IAAIC,EAAAA,WAAWN,KAAKD,IAAKC,KAAKH,IAAKG,KAAKF,SACtDE,KAAKK,OAAOE,eACZP,KAAKJ,KAAKY,kBAAkB,WAC1BL,EAAKE,OAAOI,KACVN,EAAKO,QAAQC,mBACbR,EAAKO,QAAQE,MACbT,EAAKO,QAAQG,UAEfV,EAAKE,OAAOS,SAAW,SAAAC,GACrBZ,EAAKa,UAAYD,EAAGE,WACpBd,EAAKe,UAAYH,EAAGG,WAEtBf,EAAKE,OAAOc,cAAgB,SAAAJ,GAC1BZ,EAAKiB,OAAO,UAKlB3B,EAAAQ,UAAAoB,YAAA,WACErB,KAAKK,QAAUL,KAAKK,OAAOiB,WAG7B7B,EAAAQ,UAAAmB,OAAA,SAAOG,GAAP,IAAApB,EAAAH,KACMwB,EAASxB,KAAKH,IAAI4B,IAAI,SAAAF,GAAM,OAAApB,EAAKiB,OAAOG,KACxCvB,KAAKK,OAAOqB,YACd1B,KAAK2B,QAAQJ,GAEbvB,KAAKH,IAAI+B,UAAUJ,IAGvB/B,EAAAQ,UAAA0B,QAAA,SAAQE,GAEgB,MAAlB7B,KAAKgB,WAAqBhB,KAAKkB,UAAYlB,KAAK8B,kBAClD9B,KAAKL,SAASoC,SAAS/B,KAAKgC,IAAK,UAAW,KAC5ChC,KAAKL,SAASoC,SAAS/B,KAAKgC,IAAKhC,KAAKH,IAAIoC,IAAIC,UAAW,mBAE9B,QAAlBlC,KAAKgB,WAAuBhB,KAAKkB,UAAUlB,KAAKmC,gBACzDnC,KAAKL,SAASoC,SAAS/B,KAAKgC,IAAIhC,KAAKH,IAAIoC,IAAIC,UAAW,qBACxDlC,KAAKL,SAASoC,SAAS/B,KAAKgC,IAAK,UAAW,OAGhDvC,EAAAQ,UAAAG,QAAA,WACEJ,KAAKgC,IAAMhC,KAAKN,GAAG0C,cAEnBpC,KAAKL,SAASoC,SACZ/B,KAAKgC,IACLhC,KAAKH,IAAIoC,IAAII,WACb,aAAarC,KAAKsC,iBAAgB,aAAatC,KAAKsC,uCAlFzDC,EAAAA,UAASC,KAAA,CAAC,CACTC,SAAU,iEAXVC,EAAAA,kBAEAC,EAAAA,iBAGAC,EAAAA,cAGOC,EAAAA,gBAAeC,EAAAA,qBAALC,EAAAA,wCAkBhBC,EAAAA,MAAKR,KAAA,CAAC,wBA5BT,GCAAS,EAAA,oDAGCC,EAAAA,SAAQV,KAAA,CAAC,CACRW,aAAc,CACZ1D,GAEF2D,QAAQ,CACN3D,SARJ","sourcesContent":["import {\r\n  Directive,\r\n  ElementRef,\r\n  Input,\r\n  Renderer2,\r\n  AfterViewInit,\r\n  OnDestroy,\r\n  NgZone\r\n} from \"@angular/core\";\r\nimport { ScrollView } from \"ionic-angular/util/scroll-view\";\r\nimport { Platform, App, DomController, Content } from \"ionic-angular\";\r\n\r\n@Directive({\r\n  selector: \"[hideFabOnscroll]\"\r\n})\r\nexport class HideFabOnscrollDirective implements AfterViewInit, OnDestroy {\r\n  //TODO:constants\r\n  private TOP_THRESHOLD = 56;\r\n  private BOTTOM_THRESHOLD = 10;\r\n  private TRANSITION_DELAY = \"500ms\";\r\n  //TODO: scroll view from the ionic itself for scroll events\r\n  private scroll: ScrollView;\r\n\r\n  // render vars so we aren't scoping new ones each time\r\n  private scrollDir = null;\r\n  private scrollTop = 0;\r\n\r\n  //Content where the fab button is displayed\r\n  @Input(\"hideFabOnscroll\") content: Content;\r\n  // Our fab to hide\r\n  fab: HTMLElement;\r\n\r\n  constructor(\r\n    private el: ElementRef,\r\n    private renderer: Renderer2,\r\n    // private platform: Platform,\r\n    private zone: NgZone,\r\n    public plt: Platform,\r\n    private domCtrl: DomController,\r\n    private app: App\r\n  ) {}\r\n\r\n  ngAfterViewInit() {\r\n    //After initializing all the elements , set their transiotn property\r\n    this.initFab();\r\n    // TODO: init the scroll view and enable scroll events\r\n    //then bind the function onScroll\r\n    this.scroll = new ScrollView(this.app, this.plt, this.domCtrl);\r\n    this.scroll.enableEvents();\r\n    this.zone.runOutsideAngular(() => {\r\n      this.scroll.init(\r\n        this.content.getScrollElement(),\r\n        this.content._cTop,\r\n        this.content._cBottom\r\n      );\r\n      this.scroll.onScroll = ev => {\r\n        this.scrollDir = ev.directionY;\r\n        this.scrollTop = ev.scrollTop;\r\n      };\r\n      this.scroll.onScrollStart = ev => {\r\n        this.render(null);\r\n      };\r\n    });\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.scroll && this.scroll.destroy();\r\n  }\r\n\r\n  render(ts) {\r\n    let rAFInt = this.plt.raf(ts => this.render(ts));\r\n    if (this.scroll.isScrolling) {\r\n      this.hideFab(ts);\r\n    } else {\r\n      this.plt.cancelRaf(rAFInt);\r\n    }\r\n  }\r\n  hideFab(timestamp) {\r\n    // GOING UP\r\n    if (this.scrollDir == \"up\" && this.scrollTop > this.BOTTOM_THRESHOLD) {\r\n      this.renderer.setStyle(this.fab, \"opacity\", \"1\");\r\n      this.renderer.setStyle(this.fab, this.plt.Css.transform, \"scale3d(1,1,1)\");\r\n      // GOING DOWN\r\n    } else if (this.scrollDir == \"down\" && this.scrollTop>this.TOP_THRESHOLD) {\r\n      this.renderer.setStyle(this.fab,this.plt.Css.transform, \"scale3d(.1,.1,.1)\");\r\n      this.renderer.setStyle(this.fab, \"opacity\", \"0\");\r\n    }\r\n  }\r\n  initFab() {\r\n    this.fab = this.el.nativeElement;\r\n\r\n    this.renderer.setStyle(\r\n      this.fab,\r\n      this.plt.Css.transition,\r\n      `transform ${this.TRANSITION_DELAY}, opacity ${this.TRANSITION_DELAY}`);\r\n  }\r\n}\r\n","import {NgModule } from '@angular/core';\r\nimport { HideFabOnscrollDirective } from './hide-fab-onscroll.directive';\r\nexport * from \"./hide-fab-onscroll.directive\";\r\n@NgModule({\r\n  declarations: [\r\n    HideFabOnscrollDirective\r\n  ],\r\n  exports:[\r\n    HideFabOnscrollDirective\r\n  ]\r\n})\r\nexport class HideFabOnscrollModule {}\r\n"]}